# NoneBot2 消息记录与模仿回复项目

## 项目简介

本项目基于 [NoneBot2](https://v2.nonebot.dev/) 框架，开发了一个能够记录用户消息并通过频率模型进行模仿回复的 QQ 机器人。机器人会记录每条收到的消息的内容、时间和用户信息，形成数据集，并使用该数据集训练一个简单的频率模型来模仿人类的发言。

## 目录结构

```
nonebot_project/
├── bot.py                      # NoneBot2 的主入口文件
├── .env                        # 环境变量配置文件
├── message_records.csv         # 保存消息记录的数据集文件
├── plugins/                    # 插件目录
│   ├── __init__.py             # 插件初始化文件
│   ├── record_message.py       # 记录消息的插件
│   └── reply_message.py        # 基于频率模型的回复插件
├── data/                       # 用于存储一些数据文件或模型（可选）
├── models/                     # 用于存储训练的模型文件（可选）
├── requirements.txt            # 项目的依赖包
└── README.md                   # 项目说明文档
```

## 环境配置

### 1. 安装依赖

首先，确保系统中已安装 Python 3.7 及以上版本。然后使用以下命令安装依赖包：

```bash
pip install -r requirements.txt
```

### 2. 配置环境变量

项目使用 `.env` 文件来存放必要的配置。示例如下：

```
# 配置 OneBot 适配器
ONEBOT_V11_ACCESS_TOKEN=your_access_token
ONEBOT_V11_WS_URL=ws://127.0.0.1:8080/onebot/v11/ws
```

请根据你的实际情况修改这些配置。

## 使用方法

### 1. 启动机器人

在项目根目录下执行以下命令启动机器人：

```bash
nb run
```

### 2. 记录消息

机器人运行后，将自动记录收到的每条消息，包括消息内容、发送时间和发送用户。记录的数据将保存到 `message_records.csv` 文件中。

### 3. 模仿回复

机器人会基于已记录的消息内容，通过一个简单的频率模型进行回复。当接收到类似的消息时，机器人会选择最常见的回复进行回应。

## 文件说明

- **bot.py**: NoneBot2 的主入口文件，负责启动整个项目。
- **message_records.csv**: 用于保存所有收到的消息记录，每条记录包含 `user_id`、`message`、`timestamp` 三个字段。
- **plugins/record_message.py**: 用于记录用户消息的插件。
- **plugins/reply_message.py**: 基于频率模型进行回复的插件。
- **requirements.txt**: 项目依赖的 Python 包列表。

## 未来扩展

- 增加更加智能的回复逻辑，如使用机器学习模型来生成回复内容。
- 实现更加丰富的消息过滤和处理逻辑，以提高机器人的交互性和人性化。
- 动态更新模型，实现在线学习。

## 贡献

欢迎任何形式的贡献！如果你有新的想法或改进建议，请提交 Issue 或发起 Pull Request。

## 许可证

本项目遵循 MIT 许可证，详细信息请参考 LICENSE 文件。
```

这个 `README.md` 文件涵盖了项目的基本介绍、目录结构、配置方法、使用方法和未来扩展的建议。你可以根据需要进一步修改和完善。

```

## 更新

## 实时训练模型

本项目支持实时训练频率模型，记录消息的同时会更新模型，使得机器人能够逐渐学习并适应用户的对话习惯。模型会定期保存到 `models/frequency_model.pkl` 文件中，避免重启后丢失数据。

### 如何运行

1. 机器人在接收消息时，会自动更新频率模型。
2. 更新后的模型会用于生成更加贴近用户习惯的回复。
3. 每处理 100 条消息后，模型会自动保存到 `models/frequency_model.pkl` 文件中。

